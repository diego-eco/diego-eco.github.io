---
title: "Minimización de Costos con función Cobb Douglas"
author: "Diego Lopez"
date: "2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=FALSE}
pacman::p_load(tidyverse,
               knitr,
               kableExtra)
```

## Procedimiento

$$
Q (K,L) = AK^{\alpha} L^{\beta}
$$
$$
CT = p_K \cdot K + p_L \cdot L
$$

Antes de plantear el problema de optimización, notar que podemos obtener la productividad marginal del trabajo $L$ y capital $K$ y reescribirlas de las siguientes formas útiles:

$$
\frac{\partial Q}{\partial L} = A \alpha L^{\alpha-1}K^{\beta} =   \alpha A L^{\alpha}L^{-1}K^{\beta} = \frac{ \alpha A L^{\alpha}K^{\beta}}{L} = \alpha \frac{Q}{L}
$$

$$
\frac{\partial Q}{\partial K} = A \beta L^{\alpha}K^{\beta-1} = \beta A L^{\alpha}K^{\beta}K^{-1}= \frac{ \beta A L^{\alpha}K^{\beta}}{K} = \beta \frac{Q}{K}
$$

Notar que si despejamos para $\alpha$ y $\beta$ obtenemos las elasticidades insumo de la producción:
$\alpha= \frac{\partial Q}{\partial L} \frac{L}{Y}$ y $\beta= \frac{\partial Q}{\partial K} \frac{K}{Y}$ Si $\alpha = 2$, entonces un aumento del $10\%$ en la mano de obra ($L$) dará como resultado un aumento del $20\%$ en la producción ($Y$).

Planteamos ahora el \textbf{problema de minimización restringida}:

## Resolución por método de Multiplicadores de Lagrange

$$
\underset{K,L}{\text{Min }}CT = p_K \cdot K+p_L \cdot L \\
$$
$$
\text{sujeto a   } Q=L^{\alpha} K^{\beta}
$$

$$
\textbf{L} = p_K \cdot K+p_L \cdot L + \lambda [Q-L^{\alpha} K^{\beta}]
$$

Obtenemos las condiciones de primer orden

$$
\frac{\partial \textbf{L}}{\partial L}=0 \Rightarrow p_L = \lambda \alpha A L^{\alpha-1}K^{\beta}
$$
$$
\frac{\partial \textbf{L}}{\partial K} =0 \Rightarrow p_K = \lambda \beta A L^{\alpha}K^{\beta-1}
$$
$$
\frac{\partial \textbf{L}}{\partial \lambda}=0 \Rightarrow Q = L^{\alpha} K^{\beta}
$$

Dividimos las primeras dos CPO para simplificar el problema:

$$
\frac{\frac{\partial \textbf{L}}{\partial K}}{\frac{\partial \textbf{L}}{\partial L}}= \frac{p_K}{p_L} = \frac{\lambda \beta A L^{\alpha}K^{\beta-1}}{\lambda \alpha A L^{\alpha-1}K^{\beta}}
$$
Simplificamos y resolvemos para cualquiera de los dos insumos. (Aquí resolvemos para $L$)

$$
\frac{p_K}{p_L} = \frac{\beta}{\alpha}\frac{L}{K}
$$
$$
L= \frac{p_K}{p_L} \frac{\alpha}{\beta} K
$$
Sustituímos este valor en nuestra tercer CPO (que es nuestra función de producción)

$$
Q - A L^{\alpha} K^{\beta} =0
$$

$$
Q - A \left( \frac{p_K}{p_L} \frac{\alpha}{\beta} K \right) ^{\alpha} K^{\beta} =0
$$

$$
Q = A \left( \frac{p_K}{p_L} \frac{\alpha}{\beta}\right) ^{\alpha} K^{\alpha +\beta} 
$$
$$
\frac{Q}{A} \left( \frac{p_K}{p_L} \frac{\alpha}{\beta}\right) ^{-\alpha} = K^{\alpha +\beta} 
$$

$$
K = \left( \frac{Q}{A} \right)^{\frac{1}{\alpha +\beta}}  \left( \frac{p_K}{p_L} \frac{\alpha}{\beta}\right) ^{\frac{-\alpha}{\alpha +\beta}}
$$
$$
K^* = \left( \frac{Q}{A} \right)^{\frac{1}{\alpha +\beta}}  \left( \frac{p_L}{p_K} \frac{\beta}{\alpha}\right) ^{\frac{\alpha}{\alpha +\beta}}
$$
Ahora podemos resolver para $L= \frac{p_K}{p_L} \frac{\alpha}{\beta} K$

$$
L= \frac{p_K}{p_L} \frac{\alpha}{\beta} \left( \frac{Q}{A} \right)^{\frac{1}{\alpha +\beta}}  \left( \frac{p_L}{p_K} \frac{\beta}{\alpha}\right) ^{\frac{\alpha}{\alpha +\beta}}
$$
$$
L= \frac{p_K}{p_L} \frac{\alpha}{\beta} \left( \frac{Q}{A} \right)^{\frac{1}{\alpha +\beta}}  \left( \frac{p_L}{p_K} \frac{\beta}{\alpha}\right) ^{\frac{\alpha}{\alpha +\beta}}
$$
$$
L=  \left( \frac{Q}{A} \right)^{\frac{1}{\alpha +\beta}}  \frac{p_K}{p_L} \left( \frac{p_L}{p_K} \right) ^{\frac{\alpha}{\alpha +\beta}} \frac{\alpha}{\beta}  \left( \frac{\beta}{\alpha} \right) ^{\frac{\alpha}{\alpha +\beta}}
$$
Notar que podemos expresar $\frac{p_K}{p_L}$ como $\left( \frac{p_L}{p_K} \right) ^{-1} =  \left( \frac{p_L}{p_K} \right) ^{\frac{{-\alpha +\beta}}{{\alpha +\beta}}}$

$$
L=  \left( \frac{Q}{A} \right)^{\frac{1}{\alpha +\beta}}  \left( \frac{p_K}{p_L} \right) ^{\frac{\beta}{\alpha +\beta}} \left( \frac{\alpha}{\beta} \right) ^{\frac{\beta}{\alpha +\beta}}
$$
$$
L^*=  \left( \frac{Q}{A} \right)^{\frac{1}{\alpha +\beta}}  \left( \frac{p_K}{p_L} \frac{\alpha}{\beta} \right) ^{\frac{\beta}{\alpha +\beta}}
$$

\newpage

Con los resultados en parámetros de $K^*= \left( \frac{Q}{A} \right)^{\frac{1}{\alpha +\beta}}  \left( \frac{p_L}{p_K} \frac{\beta}{\alpha}\right) ^{\frac{\alpha}{\alpha +\beta}}$ y $L^* = \left( \frac{Q}{A} \right)^{\frac{1}{\alpha +\beta}}\left( \frac{p_K}{p_L} \frac{\alpha}{\beta} \right) ^{\frac{\beta}{\alpha +\beta}}$ podemos obtener la \textbf{función de costos mínimos} o función valor del problema de optimización:

$$
C_{min}= p_K \cdot K^* + p_L \cdot L^*
$$
$$
C_{min}= p_K \cdot \left( \frac{Q}{A} \right)^{\frac{1}{\alpha +\beta}}  \left( \frac{p_L}{p_K} \frac{\beta}{\alpha}\right) ^{\frac{\alpha}{\alpha +\beta}} + p_L \cdot \left( \frac{Q}{A} \right)^{\frac{1}{\alpha +\beta}}\left( \frac{p_K}{p_L} \frac{\alpha}{\beta} \right) ^{\frac{\beta}{\alpha +\beta}}
$$
Factorizamos $\left( \frac{Q}{A} \right)^{\frac{1}{\alpha +\beta}}$

$$
C_{min}= \left( \frac{Q}{A} \right)^{\frac{1}{\alpha +\beta}}  
\left(
p_K\left( \frac{p_L}{p_K} \frac{\beta}{\alpha}\right) ^{\frac{\alpha}{\alpha +\beta}} + 
p_L\left( \frac{p_K}{p_L} \frac{\alpha}{\beta} \right) ^{\frac{\beta}{\alpha +\beta}}
\right)
$$
Simplificamos los precios de los factores y factorizamos

$$
C_{min}= \left( \frac{Q}{A} \right)^{\frac{1}{\alpha +\beta}}  p_K^{\frac{\beta}{\alpha+\beta}} p_L^{\frac{\alpha}{\alpha+\beta}}
\left(
\left(\frac{\beta}{\alpha}\right) ^{\frac{\alpha}{\alpha +\beta}} + 
\left(\frac{\alpha}{\beta} \right) ^{\frac{\beta}{\alpha +\beta}}
\right)
$$

Utilizando los resultados para nuestro problema $\alpha=\frac{3}{4}$ $\beta=\frac{1}{4}$ $Q=800$ $p_K=4$ $p_L=2$

$$
K^* = \left( \frac{Q}{A} \right)^{\frac{1}{\alpha +\beta}}  \left( \frac{p_L}{p_K} \frac{\beta}{\alpha}\right) ^{\frac{\alpha}{\alpha +\beta}} = \left( \frac{800}{1} \right)^{\frac{1}{(3/4) +(1/4)}}  \left( \frac{2}{4} \frac{(1/4)}{(3/4)}\right) ^{\frac{(3/4)}{(3/4) +(1/4)}}
$$

$$
L^*= \left( \frac{Q}{A} \right)^{\frac{1}{\alpha +\beta}}  \left( \frac{p_K}{p_L} \frac{\alpha}{\beta} \right) ^{\frac{\beta}{\alpha +\beta}} =  \left( \frac{800}{1} \right)^{\frac{1}{(3/4) +(1/4)}}  \left( \frac{4}{2} \frac{(3/4)}{(1/4)} \right) ^{\frac{(1/4)}{(3/4) +(1/4)}}
$$

$$
C_{min}= \left( \frac{800}{1} \right)^{\frac{1}{(3/4) +(1/4)}}  4^{\frac{(1/4)}{(3/4)+(1/4)}} 2^{\frac{(3/4)}{(3/4)+(1/4)}}
\left(
\left(\frac{(1/4)}{(3/4)}\right) ^{\frac{(3/4)}{(3/4) +(1/4)}} + 
\left(\frac{(3/4)}{(1/4)} \right) ^{\frac{(1/4)}{(3/4) +(1/4)}}
\right)
$$

## Cálculo mediante paquetería R

```{r}
#Parámetros a utilizar
p_K=4
p_L=2
Q=800
A=1
alpha=(3/4)
beta=(1/4)

#Cálculo de resultados de minimización de costos
K_min <- (Q/A)^(1/(alpha+beta))*((p_L/p_K)*(beta/alpha))^(alpha/(alpha+beta))
L_min <- (Q/A)^(1/(alpha+beta))*((p_K/p_L)*(alpha/beta))^(beta/(alpha+beta))
Costo_min <- ((Q/A)^(1/(alpha+beta))*(p_K)^(beta/(alpha+beta)) *
                (p_L)^(alpha/(alpha+beta)))*((beta/alpha)^(alpha/(alpha+beta)) +
                                               (alpha/beta)^(beta/(alpha+beta)))
```


```{r echo=FALSE}
Resultados <-  c(K_min,L_min,Costo_min)
Tabla_resul <- matrix(t(Resultados),nrow=1,ncol=3)
colnames(Tabla_resul)<-c("Capital (K) óptimo","Trabajo (L) óptimo","Costo mínimo")
knitr::kable(Tabla_resul, format = "latex", booktabs = TRUE,caption = "Resultados")%>%
kable_styling(latex_options = "HOLD_position")
```

